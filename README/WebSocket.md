**Описание протокола**

1. Все запросы и ответы унифицированы и могут быть описаны следующей структурой.

```json
{
    "Controller" : string,
    "Action" : string,
    "Serial" : string,
    "Hash" : string,
    "Error" : string,
    "Data" : array
}
```


| Ключ       | Тип данных | Описание                                                                |
|------------|------------|-------------------------------------------------------------------------|
| Controller | String     | Имя контроллера с которым происходит взаимодействие                     |
| Action     | String     | Имя метода с которым происходит взаимодействие                          |
| Serial     | string     | Поле для построения соответствие запрос ответ                           |
| Hash       | string     | sha1 sum от data                                                        |
| Error      | bool       | Поле содержащее описание ошибки                                         |
| Data       | array      | Массив объектов (модель объекта будет зависит от контроллера и метода)  |

- Сервер копирует Serial из запроса в ответ без изменений.
  Так на стороне клиента определяется, на какой запрос пришел ответ.
  Если инициатором запроса является сервер (например update) то, в поле Serial вкладывается случайная слово.
- Hash вычисляется из Data для проверки целостности.
  Функционал затрагивает финансовую часть, необходимо повторно проверять целостность данных.
* на время разработки отключен, т.к. высчитывать hash для ручного тестирования боль и страдания
- Error поле содержит текстовое описание ошибки. 
Путсым может быть поле Error или массив Data. (взаимоисключающие)

2. Клиент может открыть любое кол-во webSocket соединений.

Каждое соединения должно быть авторизовано токеном.

```json
{
  "Controller" : "Authorization",
  "Action" : "Get",
....
}
```

Единственное разрешенное действие без авторизации, это аутентификация.
Результатом авторизации будет получения токена.

```json
{
  "Controller" : "Authentication",
  "Action" : "Login",
....
}
```

3. Сервер может быть инициатором обмена.

   В случае если другой пользователь внёс изменения в страницу на который находится текущий пользователь уже после получения данных
   сервер отправляет update пакет, в котором содержатся только изменённые данные.

- Action будет содержать Update
- Serial будет содержать случайное слово (не используется, только для унификации)
- Data будет содержать массив объектов с изменёнными записями

4. Сервер может ответить следующей структурой

```json
{
  "Controller" : "SocketManager",
  "Action" : "Do",
....
}
```

Вслучае ошибки в стурктуры запроса.